# logonly

## 問題文
Tsukushiくんの悪友のスクリプトキディSuginaくんはTsukushiくんのサーバをハッキングしたようです。残念なことにTsukushiくんはサーバのログを標準出力で取っていただけでした。Suginaくんは次のようなメッセージを送ってきました。  
```
Tsukushiくんへ

君のサーバをハッキングしました。
Kali Linuxの中のツールとファイルを使ったらrootで簡単にログインできたけど大丈夫ですか？

Suginaより
```
添付のログを見てTsukushiくんのパスワードを教えてください。  
※パスワードがそのままフラグになります。仮にパスワードが`pass`の場合、フラグは`TsukuCTF{pass}`となります。  
[logonly](files/logonly)  

## 難易度
**guess**  

## 作問にあたって
以前参加したCTFで攻撃ログ(辞書攻撃)とレジストリファイルから攻撃者に突破されたパスワードを解析する問題がありました。  
その問題では攻撃ログから突破されたユーザ名を見つけ、レジストリのハッシュをクラックすることでそのパスワードを得る解法が想定されていました。  
その時に思いついた非想定解法を問題にしました。  
  
**お詫び**  
競技終了後に行った調査の結果、作問に使用したrockyou.txtが最新でなかったことが判明いたしました。  
最新の辞書ではフラグが`TsukuCTF{qwertzu}`となりますが、これは正解と判定されていませんでした。  
古いバージョンの辞書を用いた方は問題ありません。  
誠に申し訳ありませんでした。  

## 解法
攻撃ログを見ると複数回の認証試行があることがわかる。  
ステータスコードより214153回の失敗の後、214154回目で認証に成功しているらしい。  
ここで問題文より、Kali Linuxの中のツールとファイルを用いていることがわかる。  
さらに、ファイルを使っていることより辞書攻撃と推測する。  
辞書攻撃を行っているため、認証が成功した214154行目がパスワードであるとわかる。  
これをKali Linux標準搭載の辞書についてすべて試せばよい。  
よく利用されるrockyou.txtの214154行目を見ると`qwertyuiop[]\\`である。  
これを指定された形式に整形するとflagとなった。  

## TsukuCTF{qwertyuiop[]\\\\}
